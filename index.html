<!DOCTYPE html>
<html>
  <head>
  <base target="_top">
  <style>
    body,html { background: black; color: white;}
  </style>
  </head>

  <script>
  var elementId = id => document.getElementById(id)
  function sidebarToGs() {
    let cb = [];
    if (elementId("LevelX").checked == true){ cb.push('X-1','X-2','X-3','X-4')}
    if (elementId("LevelXI").checked == true){ cb.push('XI-1','XI-2','XI-3','XI-4')}
    if (elementId("LevelXII").checked == true){ cb.push('XII MIPA 1','XII MIPA 2','XII IPS 1','XII IPS 2')}
    let kelas = cb
    let classHeader = elementId('classHeader').value
    let ambilRange = elementId('ambilRange').value;
    let namaTemplate = elementId('namaTemplate').value;
    google.script.run.loopingsheet(kelas, ambilRange, namaTemplate, classHeader);
  }
  function btnCheckAll() {
    elementId('btnCheckAll').onclick = function(e) {
      e.preventDefault()
      let checkboxes = elementId('Level')
      for(var i=0; i<checkboxes.length; i++) {
        checkboxes[i].checked = true
      }
    }
  }

  function reset() {
    elementId('LevelX').checked = false;
    elementId('LevelXI').checked = false;
    elementId('LevelXII').checked = false;
    elementId('ambilRange').value = '';
  }
  </script>

  <body>
    <pre>
    Sheet Label
    <input type="checkbox" name="Level" id="LevelX" >Level X
    <input type="checkbox" name="Level" id="LevelXI">Level XI
    <input type="checkbox" name="Level" id="LevelXII">Level XII
    <button id="btnCheckAll" onclick="btnCheckAll()">Check All</button>
    Ambil Range : 
    <input type="text" name="ambilRange" id="ambilRange">
    Class Header in cell : 
    <input type="text" name="classHeader" id="classHeader" value="A6">
    Nama Template : 
    <input type="input" id="namaTemplate" value="Sheet1">
    <input type="button" onclick="sidebarToGs()" value="Ok" />
    <input type="reset" onclick="reset()" value="Reset" />
    <pre>
  </body>
</html>
